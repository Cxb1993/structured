<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>pmvs-triangulation: delaunay.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>delaunay.cpp File Reference</h1>
<p>Main program for delaunay triangulation and ray tracing.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="delaunay_8h_source.html">delaunay.h</a>&quot;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>

<p><a href="delaunay_8cpp_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="delaunay_8cpp.html#aa4817482b1728bf62acf8030cab9842c">usage</a> (char *prog)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; Facet &gt;::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="delaunay_8cpp.html#a4962ffe4af69f28c4e4f5a11c5783316">check_point</a> (Delaunay &amp;Tr, std::vector&lt; Cell_handle &gt; &amp;marked_cells, TPoint &amp;points, std::vector&lt; Cell_handle &gt; &amp;cells, std::vector&lt; Facet &gt; &amp;ifacets, std::vector&lt; Facet &gt;::iterator itf0, int icam, Vertex_handle vcam, int ipt, <a class="el" href="classTrStats.html">TrStats</a> *stats, CGAL::Geomview_stream &amp;gv)  throw (const char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a709a345e7b42bd53bdf4d63b43141f8e"></a><!-- doxytag: member="delaunay.cpp::dump_cell" ref="a709a345e7b42bd53bdf4d63b43141f8e" args="(Cell_handle &amp;c)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dump_cell</b> (Cell_handle &amp;c)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="delaunay_8cpp.html#a579e1dff33375e8fc00f718d8bd8b460">check_cam</a> (Delaunay &amp;Tr, TPoint &amp;points, int icam, VisiblePatches *vpatches, <a class="el" href="classTrStats.html">TrStats</a> *stats, CGAL::Geomview_stream &amp;gv)  throw (const char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="delaunay_8cpp.html#a58d7089146b4967cedb22d64665a7dcc">dump_data</a> (char *file, Delaunay &amp;T, TPoint &amp;cam_points, TPoint &amp;points, PointColor &amp;pcolors, std::vector&lt; Point &gt; &amp;normals, CGAL::Bbox_3 &amp;bb, int totpts, int nbpts0, std::vector&lt; int &gt; &amp;cameras, std::vector&lt; int &gt; &amp;bad_cameras, std::map&lt; int, VisiblePatches * &gt; &amp;image_patches, float edge_mean, float *tetra_coefs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a><!-- doxytag: member="delaunay.cpp::main" ref="a3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char **argv)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Main program for delaunay triangulation and ray tracing. </p>

<p>Definition in file <a class="el" href="delaunay_8cpp_source.html">delaunay.cpp</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a579e1dff33375e8fc00f718d8bd8b460"></a><!-- doxytag: member="delaunay.cpp::check_cam" ref="a579e1dff33375e8fc00f718d8bd8b460" args="(Delaunay &amp;Tr, TPoint &amp;points, int icam, VisiblePatches *vpatches, TrStats *stats, CGAL::Geomview_stream &amp;gv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_cam </td>
          <td>(</td>
          <td class="paramtype">Delaunay &amp;&nbsp;</td>
          <td class="paramname"> <em>Tr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPoint &amp;&nbsp;</td>
          <td class="paramname"> <em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>icam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VisiblePatches *&nbsp;</td>
          <td class="paramname"> <em>vpatches</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTrStats.html">TrStats</a> *&nbsp;</td>
          <td class="paramname"> <em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CGAL::Geomview_stream &amp;&nbsp;</td>
          <td class="paramname"> <em>gv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throw (const char *)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Find cells intersected by the rays joining the camera number icam to all its visible points. The number of intersections is added to field 'info' of cells</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>points,:</em>&nbsp;</td><td>vector of points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>icam</em>&nbsp;</td><td>: camera number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vpatches</em>&nbsp;</td><td>: vector of indices of the points that are visible from the camera</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stats</em>&nbsp;</td><td>: statistics </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="delaunay_8cpp_source.html#l00153">153</a> of file <a class="el" href="delaunay_8cpp_source.html">delaunay.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4962ffe4af69f28c4e4f5a11c5783316"></a><!-- doxytag: member="delaunay.cpp::check_point" ref="a4962ffe4af69f28c4e4f5a11c5783316" args="(Delaunay &amp;Tr, std::vector&lt; Cell_handle &gt; &amp;marked_cells, TPoint &amp;points, std::vector&lt; Cell_handle &gt; &amp;cells, std::vector&lt; Facet &gt; &amp;ifacets, std::vector&lt; Facet &gt;::iterator itf0, int icam, Vertex_handle vcam, int ipt, TrStats *stats, CGAL::Geomview_stream &amp;gv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Facet&gt;::iterator check_point </td>
          <td>(</td>
          <td class="paramtype">Delaunay &amp;&nbsp;</td>
          <td class="paramname"> <em>Tr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Cell_handle &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>marked_cells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPoint &amp;&nbsp;</td>
          <td class="paramname"> <em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Cell_handle &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>cells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Facet &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ifacets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Facet &gt;::iterator&nbsp;</td>
          <td class="paramname"> <em>itf0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>icam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vertex_handle&nbsp;</td>
          <td class="paramname"> <em>vcam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ipt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTrStats.html">TrStats</a> *&nbsp;</td>
          <td class="paramname"> <em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CGAL::Geomview_stream &amp;&nbsp;</td>
          <td class="paramname"> <em>gv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throw (const char *)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Find cells intersected by the ray joining camera num icam to point num ipt</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>points</em>&nbsp;</td><td>: vector of points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cells</em>&nbsp;</td><td>: incident cells at camera point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ifacets</em>&nbsp;</td><td>: vector of facets of incident cells to be tested. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>itf0</em>&nbsp;</td><td>: where to start in ifacets </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>icam</em>&nbsp;</td><td>: cam index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vcam</em>&nbsp;</td><td>: vertex of cam </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ipt</em>&nbsp;</td><td>: target point index</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>marked_cells</em>&nbsp;</td><td>: intersected cells are added to this vector </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stats</em>&nbsp;</td><td>: statistics </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>iterator where to start in the camera incident facet vector (try to optimize initial facets search). </dd></dl>

<p>Definition at line <a class="el" href="delaunay_8cpp_source.html#l00068">68</a> of file <a class="el" href="delaunay_8cpp_source.html">delaunay.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a58d7089146b4967cedb22d64665a7dcc"></a><!-- doxytag: member="delaunay.cpp::dump_data" ref="a58d7089146b4967cedb22d64665a7dcc" args="(char *file, Delaunay &amp;T, TPoint &amp;cam_points, TPoint &amp;points, PointColor &amp;pcolors, std::vector&lt; Point &gt; &amp;normals, CGAL::Bbox_3 &amp;bb, int totpts, int nbpts0, std::vector&lt; int &gt; &amp;cameras, std::vector&lt; int &gt; &amp;bad_cameras, std::map&lt; int, VisiblePatches * &gt; &amp;image_patches, float edge_mean, float *tetra_coefs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dump_data </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Delaunay &amp;&nbsp;</td>
          <td class="paramname"> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPoint &amp;&nbsp;</td>
          <td class="paramname"> <em>cam_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TPoint &amp;&nbsp;</td>
          <td class="paramname"> <em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PointColor &amp;&nbsp;</td>
          <td class="paramname"> <em>pcolors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Point &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>normals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CGAL::Bbox_3 &amp;&nbsp;</td>
          <td class="paramname"> <em>bb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>totpts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nbpts0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>cameras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>bad_cameras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; int, VisiblePatches * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>image_patches</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>edge_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>tetra_coefs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dump to a binary file all data needed to extract surface facets extraction :</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>: name of file </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>T</em>&nbsp;</td><td>: the delaunay structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cam_points</em>&nbsp;</td><td>: vector of cameras coords and index in cam_points. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pcolors</em>&nbsp;</td><td>: vector of initial points colors </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>normals</em>&nbsp;</td><td>: vector of intitial points normals </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bb</em>&nbsp;</td><td>: bounding box of PMVS points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>totpts</em>&nbsp;</td><td>: total number of points (PMVS points + camera points) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nbpts0</em>&nbsp;</td><td>: nb of points without cameras (= index of 1st camera) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cameras</em>&nbsp;</td><td>: vector of valid cameras giving their index in cam_points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bad_cameras</em>&nbsp;</td><td>: vector of bad cameras giving their index in cam_points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>image_patches</em>&nbsp;</td><td>: map of visible points per camera </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>edge_mean</em>&nbsp;</td><td>: average edge length (PMVS2 points only) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tetra_coefs</em>&nbsp;</td><td>: the coefficients of option -a</td></tr>
  </table>
  </dd>
</dl>
<p>The structure of the file is :</p>
<ul>
<li>4 bytes version (CGxx)</li>
<li>delaunay data</li>
<li>6 * float : bounding box (without cams)</li>
<li>3 * float : average edge length (in pmvs points), 0 0 or coefs min and max used for points addition in large tetras</li>
<li>int : nbcams = nb of "good" cameras</li>
<li>npts * 3 uchars : colors of points</li>
<li>bool : 'with_normals'</li>
<li>npts * 3-floats : normals of finite vertices</li>
<li>nbcams * 2 * int : nbcams camera indexes (in finite vertices list), nbcams original cameras nums</li>
<li>nbcell * int : finites cells info</li>
<li>nbcams * (points visible by each camera) :<ul>
<li>int : cam num</li>
<li>int : nb of visible points</li>
<li>nbv * int : indexes (in finite vertices list) of visible points</li>
</ul>
</li>
</ul>
<p>int : nbbadcams</p>
<ul>
<li>nbbadcams * 3 float : bad cameras coords </li>
</ul>

<p>Definition at line <a class="el" href="delaunay_8cpp_source.html#l00242">242</a> of file <a class="el" href="delaunay_8cpp_source.html">delaunay.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa4817482b1728bf62acf8030cab9842c"></a><!-- doxytag: member="delaunay.cpp::usage" ref="aa4817482b1728bf62acf8030cab9842c" args="(char *prog)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void usage </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>prog</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>print the unsage message </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>prog</em>&nbsp;</td><td>: program name </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="delaunay_8cpp_source.html#l00031">31</a> of file <a class="el" href="delaunay_8cpp_source.html">delaunay.cpp</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Aug 23 14:41:21 2013 for pmvs-triangulation by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
